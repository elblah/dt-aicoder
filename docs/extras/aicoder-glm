#!/bin/bash

models=$(cat << EOF
glm-4.5
glm-4.5-air
EOF
)

#MODEL=$(echo "$models" | fzf -e | cut -d';' -f1)
#[ -z "$MODEL" ] && MODEL=gemini-2.5-flash

#if [ -n "$MODEL" ]; then
#    echo "Model: $MODEL"
#fi    

export MODEL=glm-4.5

# Check if GLM_API_KEY environment variable is set
if [[ -z "$GLM_API_KEY" ]]; then
    echo "Error: GLM_API_KEY environment variable is not set"
    echo "Please set it with your GLM API key:"
    echo "  export GLM_API_KEY=your_api_key_here"
    echo "Then run this script again"
    exit 1
fi

export OPENAI_API_KEY=$GLM_API_KEY
export OPENAI_BASE_URL=https://api.z.ai/api/coding/paas/v4
export OPENAI_MODEL=$MODEL

#export DISABLE_STREAMING=1

export AUTO_COMPACT_THRESHOLD=131072

#exec uvx --reinstall --from ~/poc/aicoder/v2 aicoder
#exec uvx --from ~/poc/aicoder/v2 aicoder
exec aicoder-start
